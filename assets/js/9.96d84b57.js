(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{291:function(a,s,t){"use strict";t.r(s);var e=t(10),r=Object(e.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h2",{attrs:{id:"mysql主从备份"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql主从备份"}},[a._v("#")]),a._v(" MySQL主从备份")]),a._v(" "),s("h3",{attrs:{id:"通过日志备份"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过日志备份"}},[a._v("#")]),a._v(" 通过日志备份")]),a._v(" "),s("h4",{attrs:{id:"主库配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主库配置"}},[a._v("#")]),a._v(" 主库配置")]),a._v(" "),s("p",[a._v("my.ini配置文件")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("[mysqld]\n#server_id不能和从库一样\nserver_id= 2\n#log-bin包含路径和文件名\nlog-bin=/path-to-log/mysql-bin\n")])])]),s("p",[a._v("重启数据库")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("net stop mysql\nnet start mysql\n")])])]),s("p",[a._v("登录主数据库，查询bin-log是否打开")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql> show variables like '%log_bin%';\n")])])]),s("p",[a._v("建立用于主从复制的账号")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql> CREATE USER 'repl'@'%' IDENTIFIED BY 'password';\nmysql> GRANT REPLICATION SLAVE ON *.* TO 'repl'@'%' WITH GRANT OPTION;\nmysql> flush privileges;\n")])])]),s("p",[a._v("查看账号")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql> select user,host,plugin from user;\n")])])]),s("h4",{attrs:{id:"从库配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#从库配置"}},[a._v("#")]),a._v(" 从库配置")]),a._v(" "),s("p",[a._v("设置server-id并关闭binlog功能")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("server_id=21\nskip-log-bin\n")])])]),s("p",[a._v("重启数据库")]),a._v(" "),s("h4",{attrs:{id:"已有数据备份"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#已有数据备份"}},[a._v("#")]),a._v(" 已有数据备份")]),a._v(" "),s("p",[a._v("可通过 mysqldump 备份日志坐标节点前的所有数据")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysqldump --all-databases --master-data > dbdump.db\n")])])]),s("h4",{attrs:{id:"主库日志文件与开始位置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#主库日志文件与开始位置"}},[a._v("#")]),a._v(" 主库日志文件与开始位置")]),a._v(" "),s("p",[a._v("主库查询")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql> show master status;\n")])])]),s("p",[a._v("从库配置主库连接信息、日志路径和位置")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("mysql> CHANGE MASTER TO\n    -> MASTER_HOST='localhost',\n    -> MASTER_PORT=3306,\n    -> MASTER_USER='repl',\n    -> MASTER_PASSWORD='xxxx',\n    -> MASTER_LOG_FILE='mysql-bin.000001',\n    -> MASTER_LOG_POS=1220;\n")])])]),s("p",[a._v("启动")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("start slave;\n")])])]),s("p",[a._v("查看slave进程状态")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("show slave status\\G\n")])])]),s("h4",{attrs:{id:"验证"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#验证"}},[a._v("#")]),a._v(" 验证")]),a._v(" "),s("p",[a._v("主库")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("create database test;\n")])])]),s("p",[a._v("从库")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("show database;\n")])])]),s("h3",{attrs:{id:"通过gtid备份"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#通过gtid备份"}},[a._v("#")]),a._v(" 通过GTID备份")])])}),[],!1,null,null,null);s.default=r.exports}}]);