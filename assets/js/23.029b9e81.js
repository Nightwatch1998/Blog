(window.webpackJsonp=window.webpackJsonp||[]).push([[23],{307:function(s,t,a){"use strict";a.r(t);var n=a(10),e=Object(n.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"docker从入门到精通"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker从入门到精通"}},[s._v("#")]),s._v(" Docker从入门到精通")]),s._v(" "),t("h2",{attrs:{id:"docker概述"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker概述"}},[s._v("#")]),s._v(" Docker概述")]),s._v(" "),t("h3",{attrs:{id:"docker为什么出现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker为什么出现"}},[s._v("#")]),s._v(" Docker为什么出现")]),s._v(" "),t("p",[s._v("一款产品从应用到上线，需要配置负复杂的运行环境，需要考虑不同版本环境的兼容，而且不能跨平台，移植到另一台服务器又得重新配置一遍。")]),s._v(" "),t("p",[s._v("Docker通过镜像将应用程序所需的系统环境进行打包，解决环境配置的诸多问题。")]),s._v(" "),t("p",[s._v("Docker将应用程序运行在容器上，而容器在任何操作系统上都是一致的，这就实现了跨平台、跨服务器。“一次封装、到处运行”。")]),s._v(" "),t("p",[s._v("在容器技术出现之前，业界网红是"),t("strong",[s._v("虚拟机")]),s._v("。虚拟机的代表，是"),t("strong",[s._v("VMWare")]),s._v("和"),t("strong",[s._v("OpenStack")]),s._v("。虚拟机技术是虚拟出一套硬件之后，在其上运行一个完整的操作系统，在操作系统上再运行所需应用。")]),s._v(" "),t("p",[t("strong",[s._v("Docker和虚拟机的区别？")])]),s._v(" "),t("ul",[t("li",[s._v("虚拟机占用资源多，冗余步骤多，启动慢")]),s._v(" "),t("li",[s._v("容器内的应用直接运行于宿主机内核，容器没有自己的内核，也没有硬件虚拟，因此更为轻便。")]),s._v(" "),t("li",[s._v("每个容器相互隔离，每个容器有自己的文件系统，容器间进程不会互相影响，能区分计算资源。")])]),s._v(" "),t("h3",{attrs:{id:"docker能干嘛"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker能干嘛"}},[s._v("#")]),s._v(" Docker能干嘛")]),s._v(" "),t("ul",[t("li",[s._v("更快的应用交付和部署")]),s._v(" "),t("li",[s._v("更便捷的升级和扩容")]),s._v(" "),t("li",[s._v("更简单的系统运维")]),s._v(" "),t("li",[s._v("更高效的计算资源利用")])]),s._v(" "),t("h2",{attrs:{id:"docker安装"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker安装"}},[s._v("#")]),s._v(" Docker安装")]),s._v(" "),t("h3",{attrs:{id:"centos7"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#centos7"}},[s._v("#")]),s._v(" Centos7")]),s._v(" "),t("p",[s._v("这里使用了腾讯云个人用户1个月试用的云服务器")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://docs.docker.com/guides/",target:"_blank",rel:"noopener noreferrer"}},[s._v("官网地址"),t("OutboundLink")],1)]),s._v(" "),t("p",[s._v("安装：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# step 1: 安装必要的一些系统工具  ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" yum-utils device-mapper-persistent-data lvm2\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 2: 添加添加阿里云镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum-config-manager --add-repo https://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 3")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sed")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-i")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v("'s+download.docker.com+mirrors.aliyun.com/docker-ce+'")]),s._v(" /etc/yum.repos.d/docker-ce.repo\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 4: 更新并安装Docker-CE")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum makecache fast  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 生成缓存")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-y")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" docker-ce\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 5: 开启Docker服务")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("service")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Step 6: 检查是否安装成功")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version\n")])])]),t("p",[s._v("卸载：")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" yum remove docker-ce\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /var/lib/docker\n")])])]),t("blockquote",[t("p",[s._v("说明：")]),s._v(" "),t("ul",[t("li",[s._v("yum-utils管理yum配置和存储库,device-mapper-persistent-data用于逻辑卷管理，lvm2用于动态调整磁盘分区大小")])])]),s._v(" "),t("h3",{attrs:{id:"腾讯云镜像加速"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#腾讯云镜像加速"}},[s._v("#")]),s._v(" 腾讯云镜像加速")]),s._v(" "),t("p",[t("a",{attrs:{href:"https://cloud.tencent.com/document/product/1141/63910",target:"_blank",rel:"noopener noreferrer"}},[s._v("容器镜像服务个人版使用说明"),t("OutboundLink")],1)]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" login ccr.ccs.tencentyun.com "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--username")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("xxxxxxxxxxx\n")])])]),t("p",[s._v("执行以下命令，打开 "),t("code",[s._v("/etc/docker/daemon.json")]),s._v(" 配置文件。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("vim")]),s._v(" /etc/docker/daemon.json\n")])])]),t("p",[s._v("按 "),t("strong",[s._v("i")]),s._v(" 切换至编辑模式，添加以下内容，并保存。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"registry-mirrors"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"https://mirror.ccs.tencentyun.com"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])])]),t("p",[s._v("执行以下命令，重启 Docker 即可。示例命令以 CentOS 7 为例。")]),s._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" systemctl restart "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n")])])]),t("p",[s._v("查看镜像仓库地址")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sudo")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info\n")])])]),t("h2",{attrs:{id:"docker常用命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker常用命令"}},[s._v("#")]),s._v(" Docker常用命令")]),s._v(" "),t("h3",{attrs:{id:"帮助命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#帮助命令"}},[s._v("#")]),s._v(" 帮助命令")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 版本信息")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" info  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 系统信息")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" 命令 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--help")]),s._v("\n")])])]),t("p",[t("a",{attrs:{href:"https://docs.docker.com/reference/cli/docker/buildx/build/",target:"_blank",rel:"noopener noreferrer"}},[s._v("帮助文档地址"),t("OutboundLink")],1)]),s._v(" "),t("h3",{attrs:{id:"镜像命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像命令"}},[s._v("#")]),s._v(" 镜像命令")]),s._v(" "),t("p",[t("strong",[s._v("docker images")]),s._v(" 查看本地主机上的镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY    TAG       IMAGE ID       CREATED         SIZE\nhello-world   latest    d2c94e258dcb   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" months ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选项")]),s._v("\n  -a, "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--all")]),s._v("             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出所有镜像")]),s._v("\n  -q, "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--quiet")]),s._v("           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只显示镜像ID")]),s._v("\n\n")])])]),t("p",[t("strong",[s._v("docker search")]),s._v(" 搜索镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker search mysql")]),s._v("\nNAME                              DESCRIPTION                                     STARS     OFFICIAL\nmysql                             MySQL is a widely used, open-source relation…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15301")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nmariadb                           MariaDB Server is a high performing "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("open")]),s._v(" sou…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5828")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\nphpmyadmin                        phpMyAdmin - A web interface "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" MySQL and M…   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1017")]),s._v("      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("OK"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 可选项,搜索收藏3000以上的镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--filter")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("STARS"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3000")]),s._v("\n")])])]),t("p",[t("strong",[s._v("docker pull")]),s._v(" 下载镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载镜像docker pull 镜像名[:tag]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull mysql")]),s._v("\nUsing default tag: latest  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 如果不写tag，默认就是latest")]),s._v("\nlatest: Pulling from library/mysql\nd9a40b27c30f: Pull complete  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 分层下载, docker image的核心 联合文件系统")]),s._v("\nfe4b01031aab: Pull complete\naa72c34c4347: Pull complete\n473ade985fa2: Pull complete\ncc168a9482de: Pull complete\n3ca3786815dd: Pull complete\n3e3fac98ea83: Pull complete\n10e5505c3ae4: Pull complete\na79ade39aab9: Pull complete\nae34d51c6da2: Pull complete\nDigest: sha256:d8df069848906979fd7511db00dc22efeb0a33a990d87c3c6d3fcdafd6fc6123 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 签名")]),s._v("\nStatus: Downloaded newer image "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" mysql:latest\ndocker.io/library/mysql:latest  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 真实地址")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 等价命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull docker.io/library/mysql:latest\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 指定版本下载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull mysql:8.0\n")])])]),t("p",[t("strong",[s._v("docker rmi")]),s._v(" 删除镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f 容器ID      # 删除指定容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos docker"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f 容器ID 容器ID 容器ID     # 删除指定容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker rmi -f $(docker images -aq)   # 删除所有命令，拿到所有的ID，再用ID去删除")]),s._v("\n")])])]),t("h3",{attrs:{id:"容器命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器命令"}},[s._v("#")]),s._v(" 容器命令")]),s._v(" "),t("p",[s._v("Docker 容器是镜像的运行实例,首先需要下载一个镜像")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull centos\n")])])]),t("p",[t("strong",[s._v("新建容器并启动")])]),s._v(" "),t("p",[s._v("每一个启动过的容器都有伊恩"),t("code",[s._v("containerid")]),s._v(",包括历史启动过的")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("可选参数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v(" image\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 参数说明")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"Name"')]),s._v("   容器名字  centos1 centos2 ，用于区分容器\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("\t            后台方式运行\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v("\t\t\t\t使用交互方式运行，进入容器查看内容\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("              指定容器端口  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8080")]),s._v(":8080\n\t"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("  ip:主机端口:容器端口\n\t"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("  主机端口：容器端口\n\t"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v("  容器端口\n\t容器端口\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-P")]),s._v("              随机指定端口\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试，启动并进入容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it centos /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@37014cca6e59 /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#ls")]),s._v("\nbin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var\ndev  home  lib64  media       opt  root  sbin  sys  usr\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从容器退出到主机")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@37014cca6e59 /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin   data  etc   lib    lost+found  mnt  proc  run   srv  tmp  var\nboot  dev   home  lib64  media       opt  root  sbin  sys  usr\n\n")])])]),t("p",[t("strong",[s._v("查看运行中的容器")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps 命令")]),s._v("\n   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示最近运行的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示最近运行的容器+历史运行的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-n")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("? "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示最近创建的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-q")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 只显示容器的编号CONTAINER ID ")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps -a")]),s._v("\nCONTAINER ID   IMAGE          COMMAND       CREATED         STATUS                       PORTS     NAMES\n37014cca6e59   centos         "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" minutes ago   Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("130")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" minutes ago             condescending_dewdney\n7e27229c38ce   d2c94e258dcb   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/hello"')]),s._v("      "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" hours ago    Exited "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" hours ago                peaceful_mcnulty\n\n")])])]),t("p",[t("strong",[s._v("退出容器")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器停止退出")]),s._v("\nctrl + p + q  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器不停止退出")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it centos /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@3a87ddaae533 /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [root@VM-20-7-centos /]#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES\n3a87ddaae533   centos    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v(" seconds ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("47")]),s._v(" seconds             great_dubinsky\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#")]),s._v("\n")])])]),t("p",[t("strong",[s._v("删除容器")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" 容器id    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除指定的容器，不能删除正在运行的容器，如果要强制删除  rm -rf")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token variable"}},[t("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$(")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-aq")]),t("span",{pre:!0,attrs:{class:"token variable"}},[s._v(")")])]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除所有的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),s._v(" -q"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("xargs")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 删除所有的容器")]),s._v("\n")])])]),t("p",[t("strong",[s._v("启动和停止容器的操作")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start 容器ID     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop 容器ID      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 关闭容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart 容器ID\t  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v(" 容器ID      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 强制停止容器")]),s._v("\n")])])]),t("h3",{attrs:{id:"常用其他命令"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常用其他命令"}},[s._v("#")]),s._v(" 常用其他命令")]),s._v(" "),t("p",[t("strong",[s._v("后台启动")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d 镜像名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d centos")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 问题 docker ps 发现centos 停止了")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 常见的坑  docker 容器使用后台运行，就必须要有一个前台进程，docker发现没有前台应用，就会自动停止")]),s._v("\n")])])]),t("p",[t("strong",[s._v("查看日志")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" logs "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("参数"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 持续输出新生成的日志")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-t")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示时间戳")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--tail")]),s._v(" number "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示日志的最后几行")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker run -d centos /bin/bash -c "while true;do echo rong;sleep 1;done"')]),s._v("\n6ab070632a3786f8d15d93ace21e2bb53775ef60f6ddb72f86371962853ec2b1\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker logs -tf --tail 10 6ab07")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:29.377142371Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:30.378593786Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:31.380054880Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:32.381486168Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:33.383041959Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:34.384493754Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:35.385956572Z rong\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2024")]),s._v("-08-18T04:17:36.387386266Z rong\n")])])]),t("p",[t("strong",[s._v("查看容器的进程信息")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker top 容器id")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#  docker top 6ab070632a37")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("                 PID                 "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("                C                   STIME     \nroot                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16728")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16707")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":17     \nroot                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("18362")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("16728")]),s._v("               "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("                   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(":21     \n")])])]),t("p",[t("strong",[s._v("查看镜像的元数据")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" inspect 容器id\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker inspect 6ab070632a37")]),s._v("\n")])])]),t("p",[t("strong",[s._v("进入当前正在运行的容器")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" 容器ID /bin/bash  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器，并开启一个新的控制台")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND                  CREATED          STATUS          PORTS     NAMES\n6ab070632a37   centos    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash -c \'while…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(" minutes ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" minutes             hopeful_colden\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it 6ab070632a37 /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@6ab070632a37 /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nbin  etc   lib    lost+found  mnt  proc  run   srv  tmp  var\ndev  home  lib64  media       opt  root  sbin  sys  usr\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@6ab070632a37 /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ps -ef")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("UID")]),s._v("        PID  "),t("span",{pre:!0,attrs:{class:"token environment constant"}},[s._v("PPID")]),s._v("  C STIME TTY          TIME CMD\nroot         "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:17 ?        00:00:00 /bin/bash "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-c")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("while")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("do")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" rong"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("sleep")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("done")]),s._v("\nroot       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("905")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:32 pts/0    00:00:00 /bin/bash\nroot       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("926")]),s._v("     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:32 ?        00:00:00 /usr/bin/coreutils --coreutils-prog-shebang"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("sleep /us\nroot       "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("927")]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("905")]),s._v("  "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0")]),s._v(" 04:32 pts/0    00:00:00 "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-ef")]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 方式2")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" attach 容器ID  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器正在运行的控制台")]),s._v("\n")])])]),t("p",[t("strong",[s._v("从主机拷贝文件到容器上")])]),s._v(" "),t("p",[s._v("只要容器在，数据就在，和容器运行没运行无关")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND   CREATED   STATUS    PORTS     NAMES\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY    TAG       IMAGE ID       CREATED         SIZE\nhello-world   latest    d2c94e258dcb   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("15")]),s._v(" months ago   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("13")]),s._v(".3kB\ncentos        latest    5d0da3dc9764   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(" years ago     231MB\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -it centos /bin/bash")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@86db2950731e /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# [root@VM-20-7-centos ~]#")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos ~"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE     COMMAND       CREATED          STATUS          PORTS     NAMES\n86db2950731e   centos    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/bin/bash"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("22")]),s._v(" seconds ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("21")]),s._v(" seconds             nifty_matsumoto\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器内部")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker attach 86db2950731e")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@86db2950731e /"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /home")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@86db2950731e home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 容器内新建一个文件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@86db2950731e home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# touch test.java")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@86db2950731e home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\ntest.java\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@86db2950731e home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# exit")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将文件拷贝出来到主机上")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker cp 86db2950731e:/home/test.java  /home")]),s._v("\nSuccessfully copied "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".54kB to /home\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nlighthouse  rong.java  test.java\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 目前是手动拷贝，后面可以通过容器卷自动拷贝")]),s._v("\n")])])]),t("h3",{attrs:{id:"小结"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#小结"}},[s._v("#")]),s._v(" 小结")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/docker%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3.png",alt:"docker命令详解"}})]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("attach    Attach to a running container                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 当前    shell 下 attach 连接指定运行镜像")]),s._v("\nbuild     Build an image from a Dockerfile              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 通过    Dockerfile 定制镜像")]),s._v("\ncommit   Create a new image from a container changes   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 提交当前容器为新的镜像 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v("       Copy files/folders from the containers filesystem to the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("host")]),s._v(" path "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#从容器中拷贝指定文件或者目录到宿主机中")]),s._v("\ncreate    Create a new container                        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个新的容器，同run，但不启动容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("diff")]),s._v("     Inspect changes on a container's filesystem   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看 docker 容器变化 ")]),s._v("\nevents   Get real "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("time")]),s._v(" events from the server          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从 docker 服务获取容器实时事件")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v("      Run a "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" an existing container        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在已存在的容器上运行命令")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("export")]),s._v("    Stream the contents of a container as a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" archive   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 导出容器的内容流作为一个 tar 归档文件[对应import ]")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v("   Show the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("history")]),s._v(" of an image                  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 展示一个镜像形成历史 ")]),s._v("\nimages    List images                                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出系统当前镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("import")]),s._v("    Create a new filesystem image from the contents of a tarball "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从 tar包中的内容创建一个新的文件系统映[对应export]")]),s._v("\ninfo      Display system-wide information               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 显示系统相关信息 ")]),s._v("\ninspect   Return low-level information on a container   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器详细信息 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("kill")]),s._v("      Kill a running container                      "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# kill 指定    docker 容器")]),s._v("\nload      Load an image from a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" archive              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从一个    tar 包中加载一个镜像[对应save]")]),s._v("\nlogin     Register or Login to the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" registry server    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 注册或者登陆一个 docker 源服务器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("logout")]),s._v("    Log out from a Docker registry server          "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从当前    Docker registry 退出")]),s._v("\nlogs      Fetch the logs of a container                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 输出当前容器日志信息 ")]),s._v("\nport      Lookup the public-facing port "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("which")]),s._v(" is NAT-ed to PRIVATE_PORT    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看映射端口对应的容器内部源端口")]),s._v("\npause     Pause all processes within a container        "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 暂停容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("ps")]),s._v("        List containers                               "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 列出容器列表")]),s._v("\npull      Pull an image or a repository from the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" registry server   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 从docker镜像源服务器拉取指定镜像或者库镜像")]),s._v("\npush      Push an image or a repository to the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" registry server    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 推送指定镜像或者库镜像至docker源服务器")]),s._v("\nrestart   Restart a running container                   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启运行的容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v("        Remove one or "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" containers                 "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除一个或者多个容器 ")]),s._v("\nrmi       Remove one or "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("more")]),s._v(" images             "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 移除一个或多个镜像[无容器使用该镜像才可删除，否则需删除相关容器才可继续或    -f 强制删除]")]),s._v("\nrun       Run a "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("in")]),s._v(" a new container              "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 创建一个新的容器并运行 一个命令")]),s._v("\nsave      Save an image to a "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("tar")]),s._v(" archive                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保存一个镜像为一个 tar 包[对应load]")]),s._v("\nsearch    Search "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" an image on the Docker Hub         "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 在  docker hub 中搜索镜像")]),s._v("\nstart     Start a stopped containers                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动容器")]),s._v("\nstop      Stop a running containers                     "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 停止容器")]),s._v("\ntag       Tag an image into a repository                "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 给源中镜像打标签 ")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("top")]),s._v("       Lookup the running processes of a container   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看容器中运行的进程信 息")]),s._v("\nunpause   Unpause a paused container                    "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 取消暂停容器 ")]),s._v("\nversion   Show the "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" version information           "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看    docker 版本号")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("wait")]),s._v("      Block "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("until")]),s._v(" a container stops, "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("then")]),s._v(" print its "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v(" code   "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 截取容器停止时的退出状态值")]),s._v("\n")])])]),t("h3",{attrs:{id:"案例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#案例"}},[s._v("#")]),s._v(" 案例")]),s._v(" "),t("ol",[t("li",[s._v("部署nginx")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 1、搜索镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 2、下载镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 3、运行测试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY      TAG       IMAGE ID       CREATED         SIZE\nnginx           "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.27")]),s._v(".1    5ef79149e0ec   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("3")]),s._v(" days ago      188MB\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -d 后台运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# --name 给容器命名")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# -p 宿主机端口：容器内部端口")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d --name nginx01 -p 4396:80 nginx:1.27.1")]),s._v("\n46905d813f506080ed4b3c655b7750a3e03a31ea871d429ea3dcb8d9bbfe173c\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker ps")]),s._v("\nCONTAINER ID   IMAGE          COMMAND                  CREATED         STATUS         PORTS                                   NAMES\n46905d813f50   nginx:1.27.1   "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"/docker-entrypoint.…"')]),s._v("   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("5")]),s._v(" seconds ago   Up "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4")]),s._v(" seconds   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.0")]),s._v(".0.0:4396-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp, :::4396-"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")]),s._v("/tcp   nginx01\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试访问")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl localhost:4396")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it nginx01 /bin/bash")]),s._v("\nroot@46905d813f50:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# whereis nginx")]),s._v("\nnginx: /usr/sbin/nginx /usr/lib/nginx /etc/nginx /usr/share/nginx\nroot@46905d813f50:/"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# cd /etc/nginx")]),s._v("\nroot@46905d813f50:/etc/nginx"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# ls")]),s._v("\nconf.d  fastcgi_params  mime.types  modules  nginx.conf  scgi_params  uwsgi_params\n")])])]),t("p",[s._v("思考：每次修改nginx配置文件，都需要进入容器内部，十分麻烦！要是可以在容器外部提供一个映射路径，实现在容器外修改文件，容器内部就可以自动修改？ -v 数据卷！")]),s._v(" "),t("ol",{attrs:{start:"2"}},[t("li",[s._v("部署tomcat")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 官方推荐  --rm 用完即删 ，适用于测试")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" tomcat:9.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 下载")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" pull tomcat:9.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动运行")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4396")]),s._v(":8080 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat01 tomcat:9.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试访问没有问题")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it tomcat01 /bin/bash")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 发现问题：1、linux命令少了 2、没有webapps。 腾讯云镜像默认是最小镜像，所有不必要内容都被剔除")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 把webapps.dist下内容复制到webapps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-f")]),s._v(" webapps.dist/* webapps\n")])])]),t("p",[s._v("思考问题：部署项目每次都要进入容器十分麻烦，要是可以在容器外部提供一个映射路径，webapps,在外部防止项目，自动同步到内部就好了")]),s._v(" "),t("ol",{attrs:{start:"3"}},[t("li",[s._v("部署es+kibana")])]),s._v(" "),t("p",[s._v("kibana 是es的数据可视化和分析平台")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es暴露的端口很多")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 十分耗内存")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# es的数据一般需要放置到安全目录")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m"  elasticsearch:8.15.0')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" elasticsearch "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9200")]),s._v(":9200 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9300")]),s._v(":9300 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-e")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"discovery.type=single-node"')]),s._v(" elasticsearch：8.15.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动后就卡住了 docker stats  查看cpu状态")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker stats")]),s._v("\nCONTAINER ID   NAME            CPU %     MEM USAGE / LIMIT     MEM %     NET I/O     BLOCK I/O        PIDS\n818931fbf758   elasticsearch   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.21")]),s._v("%     "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".431GiB / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".952GiB   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("73.31")]),s._v("%    656B / 0B   429MB / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".29MB   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 添加内存限制")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m"  elasticsearch:8.15.0')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 再次查看内存使用情况")]),s._v("\nCONTAINER ID   NAME            CPU %     MEM USAGE / LIMIT   MEM %     NET I/O     BLOCK I/O        PIDS\n31bd8b696851   elasticsearch   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.99")]),s._v("%     635MiB / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")]),s._v(".952GiB   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("31.77")]),s._v("%    656B / 0B   184MB / "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("2")]),s._v(".16MB   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("83")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试会访问失败")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器  发现jdk版本不对")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker exec -it elasticsearch /bin/bash")]),s._v("\nelasticsearch@b8e6b669d669:~$ "),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("java")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-version")]),s._v("\nbash: java: "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("command")]),s._v(" not found\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装低版本es并启动、7.17.23")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker run -d --name elasticsearch -p 9200:9200 -p 9300:9300 -e "discovery.type=single-node" -e ES_JAVA_OPTS="-Xms64m -Xmx512m"  elasticsearch:7.17.23')]),s._v("\n\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试成功")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# curl localhost:9200")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"608f46e4da8c"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster_name"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker-cluster"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"cluster_uuid"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"bkVPEQmPRGerhpM-uwWaFA"')]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"number"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"7.17.23"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_flavor"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"default"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_type"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"docker"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_hash"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"61d76462eecaf09ada684d1b5d319b5ff6865a83"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_date"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"2024-07-25T14:37:42.448799567Z"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"build_snapshot"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" false,\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"lucene_version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"8.11.3"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimum_wire_compatibility_version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.8.0"')]),s._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"minimum_index_compatibility_version"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"6.0.0-beta1"')]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"tagline"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"You Know, for Search"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n")])])]),t("p",[s._v("思考：查看容器运行状态、添加限制")]),s._v(" "),t("h3",{attrs:{id:"可视化"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#可视化"}},[s._v("#")]),s._v(" 可视化")]),s._v(" "),t("blockquote",[t("p",[t("strong",[s._v("什么Portainer？")])]),s._v(" "),t("p",[s._v("Docker图形化界面管理工具！很香很好用")])]),s._v(" "),t("ul",[t("li",[s._v("Portainer（先用这个）")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8088")]),s._v(":9000 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--restart")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("always "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run/docker.sock:/var/run/docker.sock "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("true portainer/portainer\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 测试访问")]),s._v("\nhttp://server-ip:8088/\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 首次登录需要设置密码")]),s._v("\n")])])]),t("p",[t("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/portainer.png",alt:"portainer"}})]),s._v(" "),t("p",[s._v("管理界面")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/portainer%E7%AE%A1%E7%90%86%E7%95%8C%E9%9D%A2.png",alt:"portainer管理界面"}})]),s._v(" "),t("ul",[t("li",[s._v("Rancher(CI/CD 再用)")])]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装rancher-server")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" rancher-server "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("8000")]),s._v(":8080 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" \n/etc/localtime:/etc/localtime:ro  "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v("  rancher/server \n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#安装agent")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--rm")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--privileged")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" /var/run/docker.sock:/var/run/docker.sock "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v(" \n/var/lib/rancher:/var/lib/rancher rancher/agent:v1.2.11\nhttp://39.101.191.131:8000/v1/scripts/D3DBD43F263109BB881F:1577750400000:7M0y \nBzCw4XSxJklD7TpysYIpI\n")])])]),t("h2",{attrs:{id:"docker镜像"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker镜像"}},[s._v("#")]),s._v(" Docker镜像")]),s._v(" "),t("h3",{attrs:{id:"镜像是什么"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像是什么"}},[s._v("#")]),s._v(" 镜像是什么")]),s._v(" "),t("p",[s._v("镜像是一种轻量级、可执行的独立软件包，用来打包软件运行环境和基于运行环境开发的软件，它包含运行某个软件所需的所有内容，包括代码、运行时、库、环境变量和配置文件。")]),s._v(" "),t("h3",{attrs:{id:"镜像加载原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像加载原理"}},[s._v("#")]),s._v(" 镜像加载原理")]),s._v(" "),t("p",[s._v("UnionFS（联合文件系统）：")]),s._v(" "),t("ul",[t("li",[s._v("Union文件系统（UnionFS）是一种"),t("strong",[s._v("分层、轻量级并且高性能")]),s._v("的文件系统，它支持对文件系统的修改作为一次提交来一层层的叠加，同时可以将不同目录挂载到同一个虚拟文件系统下(unite several directories into a single virtual ﬁlesystem)。")]),s._v(" "),t("li",[s._v("Union 文件系统是 Docker 镜像的基础。镜像可以通过分层来进行继承，基于基础镜像（没有父镜像），可以制作各种具体的应用镜像。")]),s._v(" "),t("li",[s._v("特性：一次同时加载多个文件系统，但从外面看起来，只能看到一个文件系统，联合加载会把各层文件系统叠加起来，这样最终的文件系统会包含所有底层的文件和目录.")])]),s._v(" "),t("p",[s._v("Docker镜像加载原理：")]),s._v(" "),t("ul",[t("li",[s._v("docker的镜像实际上由一层一层的文件系统组成，这种层级的文件系统"),t("code",[s._v("UnionFS")]),s._v("。")]),s._v(" "),t("li",[t("code",[s._v("bootfs")]),s._v("(boot ﬁle system)主要包含bootloader和kernel, bootloader主要是引导加载kernel, Linux启动时，bootfs被加载到内存，提供启动内核所需的文件。启动完成后，系统会从bootfs切换到rootfs，并卸载bootfs。")]),s._v(" "),t("li",[t("code",[s._v("rootfs")]),s._v(" (root ﬁle system) ，在bootfs之上。包含的就是典型 Linux 系统中的 /dev, /proc, /bin, /etc 等标准目录和文件。rootfs就是各种不同的操作系统发行版，比如Ubuntu，Centos等等。")])]),s._v(" "),t("p",[s._v("平时安装虚拟机和centos都是好几个G，为什么Docker这里只需要200M？")]),s._v(" "),t("ul",[t("li",[s._v("对于一个精简的OS，rootfs可以很小，只需要包含最基本的命令，工具和程序库就可以了，因为底层直接用Host的kernel，自己只需要提供rootfs就好了。对于不同的linux发行版，bootfs基本是一致的，rootfs会有差别，因此不同的发行版可以共用bootfs。")])]),s._v(" "),t("blockquote",[t("p",[s._v("什么是bootfs和rootfs?")]),s._v(" "),t("ul",[t("li",[t("code",[s._v("bootfs")]),s._v(" Linux 操作系统启动时最早加载的文件系统，通常包含内核映像（Kernel Image）和初始的 RAM 文件系统。")]),s._v(" "),t("li",[t("code",[s._v("rootfs")]),s._v(" 是 Linux 系统的根文件系统，包含了操作系统运行所需的所有文件。它包括 "),t("code",[s._v("/bin")]),s._v("、"),t("code",[s._v("/lib")]),s._v("、"),t("code",[s._v("/etc")]),s._v("、"),t("code",[s._v("/dev")]),s._v(" 等目录，以及应用程序和用户数据。")])])]),s._v(" "),t("h3",{attrs:{id:"分层理解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#分层理解"}},[s._v("#")]),s._v(" 分层理解")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker pull redis")]),s._v("\nUsing default tag: latest\nlatest: Pulling from library/redis\ne4fff0779e6d: Already exists  "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重复的层不会再下载")]),s._v("\nd1dde3db2ec5: Pull complete\n1d321a003dde: Pull complete\nd65aedb2f012: Pull complete\n4018f93716a2: Pull complete\nb0967b02e8cf: Pull complete\n4f4fb700ef54: Pull complete\nd288b86f5d06: Pull complete\nDigest: sha256:878983f8f5045b28384fc300268cec62bca3b14d5e1a448bec21f28cfcc7bf78\nStatus: Downloaded newer image "),t("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("for")]),s._v(" redis:latest\ndocker.io/library/redis:latest\n")])])]),t("blockquote",[t("p",[t("strong",[s._v("思考：为什么Docker镜像要采用这种分层的结构呢？")]),s._v("\n最大的好处，我觉得莫过于是资源共享了！比如有多个镜像都从相同的Base镜像构建而来，那么宿主机\n只需在磁盘上保留一份base镜像，同时内存中也只需要加载一份base镜像，这样就可以为所有的容器服\n务了，而且镜像的每一层都可以被共享。")])]),s._v(" "),t("p",[s._v("所有的 Docker 镜像都起始于一个"),t("strong",[s._v("基础镜像层")]),s._v("，当进行修改或增加新的内容时，就会在当前镜像层之\n上，创建新的镜像层。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/%E9%95%9C%E5%83%8F%E5%88%86%E5%B1%82.png",alt:"镜像分层"}})]),s._v(" "),t("p",[s._v("Docker 通过存储引擎（新版本采用快照机制）的方式来实现镜像层堆栈，并保证多镜像层对外展示为统\n一的文件系统。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/%E9%95%9C%E5%83%8F%E7%9A%84%E4%BF%AE%E6%94%B9%E5%B1%82.png",alt:"镜像的修改层"}})]),s._v(" "),t("p",[s._v("这种情况下，上层镜像层中的文件覆盖了底层镜像层中的文件。这样就使得文件的更新版本作为一个新\n镜像层添加到镜像当中。")]),s._v(" "),t("p",[s._v("存储引擎：")]),s._v(" "),t("ul",[t("li",[s._v("Linux 上可用的存储引擎有 AUFS、Overlay2、Device Mapper、Btrfs 以及 ZFS。顾名思义，每种存储引擎都基于 Linux 中对应的文件系统或者块设备技术，并且每种存储引擎都有其独有的性能特点。")]),s._v(" "),t("li",[s._v("Windows 上仅支持 windowsﬁlter 一种存储引擎，该引擎基于 NTFS 文件系统之上实现了分层。")])]),s._v(" "),t("p",[s._v("下图展示了与系统显示相同的三层镜像。所有镜像层堆叠并合并，对外提供统一的视图。")]),s._v(" "),t("p",[t("img",{attrs:{src:"https://stag-blog.oss-cn-beijing.aliyuncs.com/picture/%E9%95%9C%E5%83%8F%E7%BB%9F%E4%B8%80%E8%A7%86%E5%9B%BE.png",alt:"镜像统一视图"}})]),s._v(" "),t("blockquote",[t("p",[s._v("Docker镜像都是只读的，当容器启动时，一个新的"),t("strong",[s._v("可写层")]),s._v("被加载到镜像的顶部！")]),s._v(" "),t("p",[s._v("这一层就是我们的容器层，容器层之下都叫镜像层。")])]),s._v(" "),t("h3",{attrs:{id:"镜像commit"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#镜像commit"}},[s._v("#")]),s._v(" 镜像commit")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit 提交容器成为一个新的本地镜像\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 命令和git原理类似")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" commit "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-m")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"描述信息"')]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-a")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"作者"')]),s._v(" 容器id 目标镜像名："),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("TAG"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),s._v("\n")])])]),t("p",[s._v("实战测试：官方的tomcat的webapps目录下是空的，我们可以自己制作一个镜像，让它包含初始内容")]),s._v(" "),t("div",{staticClass:"language-shell extra-class"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动默认的tomcat")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" run "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-d")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("--name")]),s._v(" tomcat01 "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-p")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("4396")]),s._v(":8080 tomcat:9.0\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 进入容器")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exec")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-it")]),s._v(" tomcat01 /bin/bash\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 复制webapps")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" webapps.dist/* webapps\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 退出")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("exit")]),s._v("\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启tomcat")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" restart tomcat01\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# commit 提交镜像")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v('# docker commit -m="add webapps" -a="huyadish" 6525ee04867f tomcat02:1.0')]),s._v("\nsha256:eea1dcc18db2ebe7b6d88abac28e793d8df457deb76fb99473b97053f28d66cb\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看tomcat02比tomcat 大了一点")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker images")]),s._v("\nREPOSITORY            TAG       IMAGE ID       CREATED          SIZE\ntomcat02              "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("1.0")]),s._v("       eea1dcc18db2   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("26")]),s._v(" seconds ago   468MB\ntomcat                "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("9.0")]),s._v("       90717097970a   "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("12")]),s._v(" days ago      463MB\n\n"),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 启动新的tomcat")]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("[")]),s._v("root@VM-20-7-centos home"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("]")]),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# docker run -d -p 4396:8080 tomcat02:1.0")]),s._v("\n")])])]),t("p",[s._v("学习方式思考：先简单理解概念，再动手实践，最后实践和理论结合一次性搞定这个知识")]),s._v(" "),t("p",[s._v("到这里才算入门docker")]),s._v(" "),t("h2",{attrs:{id:"容器数据卷"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#容器数据卷"}},[s._v("#")]),s._v(" 容器数据卷")]),s._v(" "),t("h2",{attrs:{id:"dockerfile"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile"}},[s._v("#")]),s._v(" DockerFile")]),s._v(" "),t("h2",{attrs:{id:"docker-网络讲解"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#docker-网络讲解"}},[s._v("#")]),s._v(" Docker 网络讲解")]),s._v(" "),t("h2",{attrs:{id:"idea整合docker"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#idea整合docker"}},[s._v("#")]),s._v(" IDEA整合Docker")]),s._v(" "),t("p",[s._v("P21")])])}),[],!1,null,null,null);t.default=e.exports}}]);